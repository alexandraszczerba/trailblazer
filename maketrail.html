<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.123/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.123/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <title>Create Your Trail</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: Arial, sans-serif;
        }

        #cesiumContainer {
            width: 100%;
            height: 100%;
            position: relative;
        }

        #infoBox {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
            z-index: 10;
            font-size: 14px;
            min-width: 150px;
        }

        #homeBtn {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 1000;
            padding: 10px 30px;
            background-color: #28a745;
            color: white;
            text-decoration: none;
            font-size: 14px;
            border-radius: 5px;
        }

        #resetTrailBtn {
            position: absolute;
            top: 60px;
            left: 10px;
            z-index: 1000;
            padding: 10px 30px;
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <a id="homeBtn" href="homepage.html">Go to Home Page</a>
    <button id="resetTrailBtn">Reset Trail</button>
    <div id="cesiumContainer"></div>
    <div id="infoBox">Click on the map to add points</div>
    <script type="module">
        Cesium.Ion.defaultAccessToken = 'your-access-token';

        import { initialize3DMap } from './maketrail.js';

        const viewer = new Cesium.Viewer('cesiumContainer', {
            terrainProvider: Cesium.createWorldTerrain(),
            timeline: false,
            animation: false,
            fullscreenButton: false,
            baseLayerPicker: false,
        });

        viewer.scene.globe.enableLighting = true;

        initialize3DMap(viewer);

        const trailheads = [
            {
                name: "Icehouse Canyon Trailhead",
                position: Cesium.Cartesian3.fromDegrees(-117.6397, 34.2501, 1500),
            },
            {
                name: "Baldy Bowl Trailhead",
                position: Cesium.Cartesian3.fromDegrees(-117.6476, 34.2889, 3050),
            },
            {
                name: "Devil's Backbone Trailhead",
                position: Cesium.Cartesian3.fromDegrees(-117.6432, 34.2880, 3050),
            },
        ];

        const trails = [
            {
                name: "Baldy Bowl Trail",
                path: [
                    Cesium.Cartesian3.fromDegrees(-117.6476, 34.2889, 2100),
                    Cesium.Cartesian3.fromDegrees(-117.6432, 34.2880, 2300),
                    Cesium.Cartesian3.fromDegrees(-117.6390, 34.2891, 2400),
                ],
                color: Cesium.Color.RED,
            },
            {
                name: "Devil's Backbone to Mount Baldy Summit",
                path: [
                    Cesium.Cartesian3.fromDegrees(-117.6432, 34.2880, 2300),
                    Cesium.Cartesian3.fromDegrees(-117.6350, 34.2895, 3068),
                ],
                color: Cesium.Color.GREEN,
            },
        ];

        function addWaypoints(waypoints) {
            waypoints.forEach((waypoint) => {
                viewer.entities.add({
                    name: waypoint.name,
                    position: waypoint.position,
                    point: {
                        pixelSize: 10,
                        color: Cesium.Color.BLUE,
                        outlineColor: Cesium.Color.WHITE,
                        outlineWidth: 2,
                    },
                    label: {
                        text: waypoint.name,
                        font: "14pt monospace",
                        style: Cesium.LabelStyle.FILL_AND_OUTLINE,
                        outlineWidth: 2,
                        verticalOrigin: Cesium.VerticalOrigin.BOTTOM,
                        pixelOffset: new Cesium.Cartesian2(0, -10),
                    },
                });
            });
        }

        function addTrails(trails) {
            trails.forEach((trail) => {
                viewer.entities.add({
                    name: trail.name,
                    polyline: {
                        positions: trail.path,
                        width: 5,
                        material: trail.color,
                        clampToGround: true,
                    },
                });
            });
        }

        addWaypoints(trailheads);
        addTrails(trails);
    </script>
</body>
</html>
